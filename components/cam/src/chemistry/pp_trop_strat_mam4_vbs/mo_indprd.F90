




      module mo_indprd

      use shr_kind_mod, only : r8 => shr_kind_r8

      private
      public :: indprd

      contains

      subroutine indprd( class, prod, nprod, y, extfrc, rxt, ncol )

      use chem_mods, only : gas_pcnst, extcnt, rxntot
      use ppgrid, only : pver

      implicit none

!--------------------------------------------------------------------
! ... dummy arguments
!--------------------------------------------------------------------
      integer, intent(in) :: class
      integer, intent(in) :: ncol
      integer, intent(in) :: nprod
      real(r8), intent(in) :: y(ncol,pver,gas_pcnst)
      real(r8), intent(in) :: rxt(ncol,pver,rxntot)
      real(r8), intent(in) :: extfrc(ncol,pver,extcnt)
      real(r8), intent(inout) :: prod(ncol,pver,nprod)

!--------------------------------------------------------------------
! ... "independent" production for Explicit species
!--------------------------------------------------------------------
      if( class == 1 ) then
         prod(:,:,1) = 0._r8

         prod(:,:,2) =.100_r8*rxt(:,:,313)*y(:,:,59)*y(:,:,1)

         prod(:,:,3) =rxt(:,:,190)*y(:,:,7)*y(:,:,5)

         prod(:,:,4) = 0._r8

         prod(:,:,5) = 0._r8

         prod(:,:,6) = 0._r8

         prod(:,:,7) = 0._r8

         prod(:,:,8) = 0._r8

         prod(:,:,9) = 0._r8

         prod(:,:,10) = 0._r8

         prod(:,:,11) = 0._r8

         prod(:,:,12) = 0._r8

         prod(:,:,13) = 0._r8

         prod(:,:,14) = 0._r8

         prod(:,:,15) = 0._r8

         prod(:,:,16) = 0._r8

         prod(:,:,17) = 0._r8

         prod(:,:,18) = 0._r8

         prod(:,:,19) = 0._r8

         prod(:,:,20) = 0._r8

         prod(:,:,21) = 0._r8

         prod(:,:,22) = (rxt(:,:,266)*y(:,:,17) +rxt(:,:,267)*y(:,:,17) + &
                 rxt(:,:,278)*y(:,:,42) +rxt(:,:,293)*y(:,:,49) + &
                 .500_r8*rxt(:,:,306)*y(:,:,54) +.800_r8*rxt(:,:,307)*y(:,:,52) + &
                 rxt(:,:,308)*y(:,:,53) +.500_r8*rxt(:,:,359)*y(:,:,81) + &
                 1.800_r8*rxt(:,:,483)*y(:,:,150))*y(:,:,22) &
                  + (.200_r8*rxt(:,:,313)*y(:,:,59) +.100_r8*rxt(:,:,337)*y(:,:,77) + &
                 .270_r8*rxt(:,:,463)*y(:,:,139) +.270_r8*rxt(:,:,464)*y(:,:,140) + &
                 .270_r8*rxt(:,:,465)*y(:,:,141) +.270_r8*rxt(:,:,466)*y(:,:,142) + &
                 .270_r8*rxt(:,:,467)*y(:,:,143))*y(:,:,1) + (rxt(:,:,301)*y(:,:,6) + &
                 .900_r8*rxt(:,:,304)*y(:,:,13) +2.000_r8*rxt(:,:,305)*y(:,:,48) + &
                 2.000_r8*rxt(:,:,355)*y(:,:,76) +rxt(:,:,376)*y(:,:,97) + &
                 rxt(:,:,393)*y(:,:,103))*y(:,:,48) &
                  + (.450_r8*rxt(:,:,353)*y(:,:,23) +rxt(:,:,354)*y(:,:,13) + &
                 2.000_r8*rxt(:,:,356)*y(:,:,76))*y(:,:,76) &
                  + (rxt(:,:,406)*y(:,:,156) +.900_r8*rxt(:,:,480)*y(:,:,149)) &
                 *y(:,:,6) +.500_r8*rxt(:,:,482)*y(:,:,149)*y(:,:,13) &
                  +.400_r8*rxt(:,:,407)*y(:,:,156)*y(:,:,23) +rxt(:,:,58)*y(:,:,54) &
                  +.400_r8*rxt(:,:,59)*y(:,:,58) +.800_r8*rxt(:,:,91)*y(:,:,150) &
                  +rxt(:,:,89)*y(:,:,151)

         prod(:,:,23) = 0._r8

         prod(:,:,24) = 0._r8

!--------------------------------------------------------------------
! ... "independent" production for Implicit species
!--------------------------------------------------------------------
      else if( class == 4 ) then
         prod(:,:,218) = 0._r8

         prod(:,:,212) =.180_r8*rxt(:,:,55)*y(:,:,12) +rxt(:,:,53)*y(:,:,243) &
                  +2.000_r8*rxt(:,:,1)

         prod(:,:,215) =rxt(:,:,4)*y(:,:,4)

         prod(:,:,182) =1.440_r8*rxt(:,:,55)*y(:,:,12)

         prod(:,:,189) =.380_r8*rxt(:,:,55)*y(:,:,12) +rxt(:,:,53)*y(:,:,243) &
                  + extfrc(:,:,3)

         prod(:,:,79) = + extfrc(:,:,15)

         prod(:,:,213) = + extfrc(:,:,1)

         prod(:,:,219) = + extfrc(:,:,2)

         prod(:,:,210) =.330_r8*rxt(:,:,55)*y(:,:,12) + extfrc(:,:,16)

         prod(:,:,211) = 0._r8

         prod(:,:,162) = 0._r8

         prod(:,:,115) = 0._r8

         prod(:,:,94) = 0._r8

         prod(:,:,206) =rxt(:,:,54)*y(:,:,12) +rxt(:,:,35)*y(:,:,159) +rxt(:,:,46) &
                 *y(:,:,160)

         prod(:,:,116) = 0._r8

         prod(:,:,80) = 0._r8

         prod(:,:,66) = 0._r8

         prod(:,:,208) =.180_r8*rxt(:,:,55)*y(:,:,12)

         prod(:,:,205) = (rxt(:,:,54) +.330_r8*rxt(:,:,55))*y(:,:,12)

         prod(:,:,214) = 0._r8

         prod(:,:,141) = 0._r8

         prod(:,:,204) =.050_r8*rxt(:,:,55)*y(:,:,12)

         prod(:,:,209) =rxt(:,:,35)*y(:,:,159) +3.000_r8*rxt(:,:,38)*y(:,:,161) &
                  +2.000_r8*rxt(:,:,39)*y(:,:,162) +3.000_r8*rxt(:,:,40)*y(:,:,163) &
                  +rxt(:,:,41)*y(:,:,164) +4.000_r8*rxt(:,:,36)*y(:,:,165) &
                  +3.000_r8*rxt(:,:,37)*y(:,:,166) +rxt(:,:,50)*y(:,:,168) &
                  +2.000_r8*rxt(:,:,44)*y(:,:,169) +rxt(:,:,45)*y(:,:,170) &
                  +2.000_r8*rxt(:,:,42)*y(:,:,171) +rxt(:,:,43)*y(:,:,172)

         prod(:,:,78) = 0._r8

         prod(:,:,217) = 0._r8

         prod(:,:,74) = 0._r8

         prod(:,:,67) = 0._r8

         prod(:,:,216) = 0._r8

         prod(:,:,163) = 0._r8

         prod(:,:,170) = 0._r8

         prod(:,:,89) = 0._r8

         prod(:,:,220) =rxt(:,:,46)*y(:,:,160) +rxt(:,:,47)*y(:,:,167) +rxt(:,:,50) &
                 *y(:,:,168) +2.000_r8*rxt(:,:,48)*y(:,:,173) +2.000_r8*rxt(:,:,49) &
                 *y(:,:,174) +3.000_r8*rxt(:,:,51)*y(:,:,175) +2.000_r8*rxt(:,:,52) &
                 *y(:,:,176)

         prod(:,:,207) = 0._r8

         prod(:,:,158) = 0._r8

         prod(:,:,157) = 0._r8

         prod(:,:,132) = 0._r8

         prod(:,:,181) = 0._r8

         prod(:,:,167) = 0._r8

         prod(:,:,152) = 0._r8

         prod(:,:,191) = 0._r8

         prod(:,:,133) = 0._r8

         prod(:,:,134) = 0._r8

         prod(:,:,203) = 0._r8

         prod(:,:,127) = 0._r8

         prod(:,:,124) = 0._r8

         prod(:,:,97) = 0._r8

         prod(:,:,135) = 0._r8

         prod(:,:,107) = 0._r8

         prod(:,:,136) = 0._r8

         prod(:,:,143) = 0._r8

         prod(:,:,169) = 0._r8

         prod(:,:,193) = 0._r8

         prod(:,:,137) = 0._r8

         prod(:,:,125) = 0._r8

         prod(:,:,118) = 0._r8

         prod(:,:,166) = 0._r8

         prod(:,:,105) = 0._r8

         prod(:,:,129) = 0._r8

         prod(:,:,106) = 0._r8

         prod(:,:,108) = 0._r8

         prod(:,:,138) = 0._r8

         prod(:,:,177) = 0._r8

         prod(:,:,145) = 0._r8

         prod(:,:,130) = 0._r8

         prod(:,:,146) = 0._r8

         prod(:,:,102) = 0._r8

         prod(:,:,84) = 0._r8

         prod(:,:,85) = 0._r8

         prod(:,:,149) = 0._r8

         prod(:,:,144) = 0._r8

         prod(:,:,178) = 0._r8

         prod(:,:,121) = 0._r8

         prod(:,:,147) = 0._r8

         prod(:,:,173) = 0._r8

         prod(:,:,75) = 0._r8

         prod(:,:,81) = 0._r8

         prod(:,:,77) = 0._r8

         prod(:,:,76) = 0._r8

         prod(:,:,122) = 0._r8

         prod(:,:,117) = 0._r8

         prod(:,:,123) = 0._r8

         prod(:,:,98) = 0._r8

         prod(:,:,142) = 0._r8

         prod(:,:,93) = 0._r8

         prod(:,:,109) = 0._r8

         prod(:,:,119) = 0._r8

         prod(:,:,95) = 0._r8

         prod(:,:,140) = 0._r8

         prod(:,:,104) = 0._r8

         prod(:,:,150) = 0._r8

         prod(:,:,83) = 0._r8

         prod(:,:,113) = 0._r8

         prod(:,:,103) = 0._r8

         prod(:,:,86) = 0._r8

         prod(:,:,128) = 0._r8

         prod(:,:,156) = 0._r8

         prod(:,:,185) = 0._r8

         prod(:,:,70) = 0._r8

         prod(:,:,82) = 0._r8

         prod(:,:,120) = 0._r8

         prod(:,:,112) = 0._r8

         prod(:,:,155) = 0._r8

         prod(:,:,154) = 0._r8

         prod(:,:,171) = 0._r8

         prod(:,:,174) = 0._r8

         prod(:,:,175) = 0._r8

         prod(:,:,172) = 0._r8

         prod(:,:,176) = 0._r8

         prod(:,:,7) = 0._r8

         prod(:,:,13) = + extfrc(:,:,5)

         prod(:,:,179) = 0._r8

         prod(:,:,188) = 0._r8

         prod(:,:,184) = 0._r8

         prod(:,:,139) = 0._r8

         prod(:,:,183) = 0._r8

         prod(:,:,160) = 0._r8

         prod(:,:,187) = 0._r8

         prod(:,:,165) = 0._r8

         prod(:,:,126) = 0._r8

         prod(:,:,131) = 0._r8

         prod(:,:,153) = 0._r8

         prod(:,:,198) = 0._r8

         prod(:,:,201) = 0._r8

         prod(:,:,87) = 0._r8

         prod(:,:,71) = 0._r8

         prod(:,:,199) = 0._r8

         prod(:,:,195) = 0._r8

         prod(:,:,200) = 0._r8

         prod(:,:,99) = 0._r8

         prod(:,:,202) = 0._r8

         prod(:,:,164) = 0._r8

         prod(:,:,100) = 0._r8

         prod(:,:,68) = 0._r8

         prod(:,:,159) = 0._r8

         prod(:,:,110) = 0._r8

         prod(:,:,180) = 0._r8

         prod(:,:,111) = 0._r8

         prod(:,:,161) = 0._r8

         prod(:,:,90) = 0._r8

         prod(:,:,186) = 0._r8

         prod(:,:,192) = 0._r8

         prod(:,:,151) = 0._r8

         prod(:,:,91) = 0._r8

         prod(:,:,72) = 0._r8

         prod(:,:,101) = 0._r8

         prod(:,:,190) = 0._r8

         prod(:,:,196) = 0._r8

         prod(:,:,194) = 0._r8

         prod(:,:,73) = 0._r8

         prod(:,:,197) = 0._r8

         prod(:,:,92) = 0._r8

         prod(:,:,148) = 0._r8

         prod(:,:,96) = 0._r8

         prod(:,:,168) = 0._r8

         prod(:,:,114) = 0._r8

         prod(:,:,69) = + extfrc(:,:,4)

         prod(:,:,88) = 0._r8

         prod(:,:,1) = 0._r8

         prod(:,:,2) = 0._r8

         prod(:,:,3) = 0._r8

         prod(:,:,4) = 0._r8

         prod(:,:,5) = 0._r8

         prod(:,:,6) = 0._r8

         prod(:,:,8) = 0._r8

         prod(:,:,9) = 0._r8

         prod(:,:,10) = 0._r8

         prod(:,:,11) = 0._r8

         prod(:,:,12) = 0._r8

         prod(:,:,14) = 0._r8

         prod(:,:,15) = 0._r8

         prod(:,:,16) = 0._r8

         prod(:,:,17) = 0._r8

         prod(:,:,18) = 0._r8

         prod(:,:,19) = + extfrc(:,:,6)

         prod(:,:,20) = + extfrc(:,:,8)

         prod(:,:,21) = + extfrc(:,:,10)

         prod(:,:,22) = 0._r8

         prod(:,:,23) = 0._r8

         prod(:,:,24) = + extfrc(:,:,12)

         prod(:,:,25) = + extfrc(:,:,7)

         prod(:,:,26) = 0._r8

         prod(:,:,27) = 0._r8

         prod(:,:,28) = 0._r8

         prod(:,:,29) = 0._r8

         prod(:,:,30) = 0._r8

         prod(:,:,31) = 0._r8

         prod(:,:,32) = 0._r8

         prod(:,:,33) = 0._r8

         prod(:,:,34) = 0._r8

         prod(:,:,35) = 0._r8

         prod(:,:,36) = 0._r8

         prod(:,:,37) = 0._r8

         prod(:,:,38) = 0._r8

         prod(:,:,39) = 0._r8

         prod(:,:,40) = 0._r8

         prod(:,:,41) = 0._r8

         prod(:,:,42) = 0._r8

         prod(:,:,43) = 0._r8

         prod(:,:,44) = 0._r8

         prod(:,:,45) = 0._r8

         prod(:,:,46) = 0._r8

         prod(:,:,47) = 0._r8

         prod(:,:,48) = 0._r8

         prod(:,:,49) = 0._r8

         prod(:,:,50) = 0._r8

         prod(:,:,51) = 0._r8

         prod(:,:,52) = 0._r8

         prod(:,:,53) = 0._r8

         prod(:,:,54) = 0._r8

         prod(:,:,55) = 0._r8

         prod(:,:,56) = 0._r8

         prod(:,:,57) = 0._r8

         prod(:,:,58) = + extfrc(:,:,13)

         prod(:,:,59) = 0._r8

         prod(:,:,60) = 0._r8

         prod(:,:,61) = 0._r8

         prod(:,:,62) = 0._r8

         prod(:,:,63) = + extfrc(:,:,9)

         prod(:,:,64) = + extfrc(:,:,11)

         prod(:,:,65) = + extfrc(:,:,14)

      end if

      end subroutine indprd

      end module mo_indprd
